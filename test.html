<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>وب‌اپ مانتو فروشی با فیلتر رنگ و سایز</title>
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      background-color: #f5f7fa;
      margin: 0;
      padding: 20px;
      font-size: 18px;
    }
    /* تب‌ها */
    .tabs {
      max-width: 600px;
      margin: 0 auto 30px;
      display: flex;
      justify-content: center;
      gap: 120px;
      border-bottom: 2px solid #ddd;
    }
    .tab {
      cursor: pointer;
      font-weight: bold;
      font-size: 24px;
      padding-bottom: 8px;
      color: #666;
      transition: color 0.3s, border-bottom 0.3s;
      border-bottom: 3px solid transparent;
      user-select: none;
    }
    .tab.active {
      color: #0066cc;
      border-bottom-color: #0066cc;
    }

    .section {
      background-color: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: 0 auto 30px;
    }
    .section h2 {
      margin-top: 0;
      color: #333;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input[type="text"], input[type="number"], input[type="file"], select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
      font-size: 18px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #0066cc;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
    }
    button:hover {
      background-color: #004a99;
    }
    .manto-list {
      margin-top: 20px;
    }
    .manto-item {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 8px;
      cursor: pointer;
    }
    .manto-item:hover {
      background-color: #f0f0f0;
    }
    .details {
      margin-top: 10px;
      font-size: 16px;
      color: #555;
    }
    #manageSection div {
      margin-bottom: 10px;
    }
    #manageSection button {
      margin-right: 10px;
      padding: 2px 10px;
    }
    img.preview {
      width: 100%;
      height: auto;
      object-fit: contain;
      margin-top: 10px;
      border-radius: 8px;
      aspect-ratio: 2/3;
    }
    .size-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    .size-grid label {
      width: 80px;
    }
    #sizeCheckboxes {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 5px;
    }
    #sizeCheckboxes label {
  cursor: pointer;
  user-select: none;
  font-weight: normal;
  font-size: 20px; /* بزرگ‌تر کردن فونت متن */
}

#sizeCheckboxes input[type="checkbox"] {
  width: 24px;    /* بزرگ‌تر کردن چک‌باکس */
  height: 24px;
  transform: translateY(4px); /* تراز عمودی با متن */
}

    #colorFilter {
      margin-top: 15px;
      width: 100%;
      padding: 10px;
      font-size: 18px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    #addForm .size-title {
      font-weight: bold;
      font-size: 20px;
      margin-top: 20px;
      margin-bottom: 10px;
      color: #333;
    }
    #sizeControls {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

#sizeControls div {
  background: #f1f1f1;
  padding: 8px;
  border-radius: 8px;
  font-size: 14px;
}
#sizeControls button {
  padding: 2px 6px;
  font-size: 14px;
  margin: 0 2px;
}



  </style>
</head>
<body>

  <!-- تب‌ها -->
  <div class="tabs">
    <div class="tab active" data-target="searchSection">جستجو</div>
    <div class="tab" data-target="manageSectionWrapper">مدیریت</div>
    <div class="tab" data-target="addSection">افزودن</div>
  </div>

  <!-- جستجو -->
  <div id="searchSection" class="section">
    <h2>جستجوی مانتو</h2>
    <label>فیلتر بر اساس سایز:</label>
    <div id="sizeCheckboxes">
      <label><input type="checkbox" value="36" /> ۳۶</label>
      <label><input type="checkbox" value="37" /> ۳۷</label>
      <label><input type="checkbox" value="40" /> ۴۰</label>
      <label><input type="checkbox" value="42" /> ۴۲</label>
      <label><input type="checkbox" value="44" /> ۴۴</label>
      <label><input type="checkbox" value="46" /> ۴۶</label>
      <label><input type="checkbox" value="48" /> ۴۸</label>
      <label><input type="checkbox" value="50" /> ۵۰</label>
      <label><input type="checkbox" value="52" /> ۵۲</label>
      <label><input type="checkbox" value="54" /> ۵۴</label>
      <label><input type="checkbox" value="2" /> ۲</label>
      <label><input type="checkbox" value="4" /> ۴</label>
      <label><input type="checkbox" value="6" /> ۶</label>
      <label><input type="checkbox" value="8" /> ۸</label>
    </div>

    <label for="colorFilter">فیلتر بر اساس رنگ:</label>
    <select id="colorFilter">
      <option value="">همه رنگ‌ها</option>
      <option value="مشکی">مشکی</option>
      <option value="سرمه‌ای">سرمه‌ای</option>
      <option value="طوسی">طوسی</option>
      <option value="ذغالی">ذغالی</option>
      <option value="قهوه‌ای">قهوه‌ای</option>
      <option value="سبز">سبز</option>
      <option value="کرم">کرم</option>
      <option value="آبی">آبی</option>
      <option value="سایر">سایر</option>
    </select>

    <div class="manto-list" id="mantoList"></div>
  </div>

  <!-- مدیریت مانتوها (wrapper برای کنترل نمایش تب) -->
  <div id="manageSectionWrapper" class="section" style="display:none;">
    <h2>مدیریت مانتوها</h2>
    <label for="manageSelect">انتخاب مانتو:</label>
    <select id="manageSelect">
      <option value="">-- انتخاب مانتو --</option>
    </select>
    <div id="manageSection" style="margin-top: 20px; display: none;">
      <img id="managePhoto" class="preview" src="" alt="نمایش عکس" />
      <h3>موجودی سایزها:</h3>
      <div id="sizeControls"></div>
      <button id="saveChangesBtn" style="background-color: green; color: white; margin-top: 20px;">ثبت تغییرات</button>
    </div>
  </div>

  <!-- افزودن مانتو -->
  <div id="addSection" class="section" style="display:none;">
    <h2>افزودن مانتو</h2>
    <form id="addForm">
      <label for="photo">عکس مانتو:</label>
      <input type="file" id="photo" accept="image/*" />

      <label for="name">نام مانتو:</label>
      <input type="text" id="name" />

      <label for="code">کد مانتو:</label>
      <input type="text" id="code" />

      <label for="price">قیمت مانتو (تومان):</label>
      <input type="number" id="price" />

      <label for="color">رنگ مانتو:</label>
      <select id="color">
        <option>مشکی</option>
        <option>سرمه‌ای</option>
        <option>طوسی</option>
        <option>ذغالی</option>
        <option>قهوه‌ای</option>
        <option>سبز</option>
        <option>کرم</option>
        <option>آبی</option>
        <option>سایر</option>
      </select>

      <div class="size-title">موجودی هر سایز:</div>
      <div class="size-grid">
        <label>سایز ۳۶:<input type="number" id="size36" min="0" /></label>
        <label>سایز ۳۷:<input type="number" id="size37" min="0" /></label>
        <label>سایز ۴۰:<input type="number" id="size40" min="0" /></label>
        <label>سایز ۴۲:<input type="number" id="size42" min="0" /></label>
        <label>سایز ۴۴:<input type="number" id="size44" min="0" /></label>
        <label>سایز ۴۶:<input type="number" id="size46" min="0" /></label>
        <label>سایز ۴۸:<input type="number" id="size48" min="0" /></label>
        <label>سایز ۵۰:<input type="number" id="size50" min="0" /></label>
        <label>سایز ۵۲:<input type="number" id="size52" min="0" /></label>
        <label>سایز ۵۴:<input type="number" id="size54" min="0" /></label>
        <label>سایز ۲:<input type="number" id="size2" min="0" /></label>
        <label>سایز ۴:<input type="number" id="size4" min="0" /></label>
        <label>سایز ۶:<input type="number" id="size6" min="0" /></label>
        <label>سایز ۸:<input type="number" id="size8" min="0" /></label>
      </div>

      <button type="submit">ثبت مانتو</button>
    </form>
  </div>

  <script>
    // کد تب‌ها
    const tabs = document.querySelectorAll('.tab');
    const sections = {
      searchSection: document.getElementById('searchSection'),
      manageSectionWrapper: document.getElementById('manageSectionWrapper'),
      addSection: document.getElementById('addSection'),
    };

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // حذف کلاس اکتیو از همه تب‌ها
        tabs.forEach(t => t.classList.remove('active'));
        // نمایش و مخفی کردن بخش‌ها
        Object.keys(sections).forEach(key => {
          sections[key].style.display = (key === tab.dataset.target) ? 'block' : 'none';
        });
        tab.classList.add('active');
      });
    });

    // همین کدهایی که قبلا داشتی رو اینجا اضافه کن
    // دیتا و منطق
    let mantos = [];

    // برای نمایش عکس مانتو در افزودن
    const photoInput = document.getElementById('photo');
    let photoDataUrl = '';

    photoInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        photoDataUrl = e.target.result;
      };
      reader.readAsDataURL(file);
    });

    // افزودن مانتو
    const addForm = document.getElementById('addForm');
    addForm.addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const code = document.getElementById('code').value.trim();
      const price = parseInt(document.getElementById('price').value);
      const color = document.getElementById('color').value;
      if (!name || !code || !price || !photoDataUrl) {
        alert('لطفاً همه موارد را پر کنید و عکس انتخاب کنید.');
        return;
      }
      // موجودی سایزها
      const sizes = ['36','37','40','42','44','46','48','50','52','54','2','4','6','8'];
      const inventory = {};
      sizes.forEach(sz => {
        const val = parseInt(document.getElementById('size' + sz).value);
        inventory[sz] = isNaN(val) ? 0 : val;
      });

      // اضافه کردن به آرایه
      mantos.push({
        photo: photoDataUrl,
        name, code, price, color,
        inventory
      });
      alert('مانتو اضافه شد.');
      addForm.reset();
      photoDataUrl = '';
      renderMantos();
      populateManageSelect();
    });

    // نمایش لیست مانتوها در جستجو با فیلتر
    const mantoList = document.getElementById('mantoList');
    const colorFilter = document.getElementById('colorFilter');
    const sizeCheckboxes = document.querySelectorAll('#sizeCheckboxes input[type="checkbox"]');

    function renderMantos() {
      const selectedSizes = Array.from(sizeCheckboxes).filter(ch => ch.checked).map(ch => ch.value);
      const selectedColor = colorFilter.value;

      mantoList.innerHTML = '';

      mantos.forEach((manto, idx) => {
        // فیلتر رنگ
        if (selectedColor && manto.color !== selectedColor) return;
        // فیلتر سایز - اگر هیچ سایزی انتخاب نشده باشه همه رو نمایش بده
        if (selectedSizes.length > 0) {
          let found = false;
          for (const sz of selectedSizes) {
            if ((manto.inventory[sz] ?? 0) > 0) {
              found = true;
              break;
            }
          }
          if (!found) return;
        }

        // ساخت آیتم نمایش
        const div = document.createElement('div');
        div.className = 'manto-item';
        div.innerHTML = `
          <img src="${manto.photo}" alt="${manto.name}" style="width: 100%; height: auto; border-radius: 12px; aspect-ratio: 2/3; object-fit: contain;" />
          <h3>${manto.name} (کد: ${manto.code})</h3>
          <div class="details">قیمت: ${manto.price.toLocaleString()} تومان</div>
          <div class="details">رنگ: ${manto.color}</div>
        `;
        mantoList.appendChild(div);
      });

      if (!mantoList.hasChildNodes()) {
        mantoList.innerHTML = '<p>هیچ مانتویی با فیلترهای انتخاب شده یافت نشد.</p>';
      }
    }

    colorFilter.addEventListener('change', renderMantos);
    sizeCheckboxes.forEach(ch => ch.addEventListener('change', renderMantos));

    // مدیریت مانتوها
    const manageSelect = document.getElementById('manageSelect');
    const manageSection = document.getElementById('manageSection');
    const managePhoto = document.getElementById('managePhoto');
    const sizeControls = document.getElementById('sizeControls');
    const saveChangesBtn = document.getElementById('saveChangesBtn');

    function populateManageSelect() {
      manageSelect.innerHTML = '<option value="">-- انتخاب مانتو --</option>';
      mantos.forEach((m, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `${m.name} (${m.code})`;
        manageSelect.appendChild(opt);
      });
    }

    let currentManageIndex = null;

    manageSelect.addEventListener('change', () => {
      const idx = manageSelect.value;
      if (idx === '') {
        manageSection.style.display = 'none';
        currentManageIndex = null;
        return;
      }
      currentManageIndex = parseInt(idx);
      const m = mantos[currentManageIndex];
      managePhoto.src = m.photo;
      sizeControls.innerHTML = '';
      Object.entries(m.inventory).forEach(([sz, val]) => {
        const div = document.createElement('div');
        div.innerHTML = `
          <span>سایز ${sz}: ${val}</span>
          <button data-size="${sz}" data-action="decrease">-</button>
          <button data-size="${sz}" data-action="increase">+</button>
        `;
        sizeControls.appendChild(div);
      });
      manageSection.style.display = 'block';
    });

    sizeControls.addEventListener('click', e => {
      if (e.target.tagName !== 'BUTTON') return;
      if (currentManageIndex === null) return;
      const btn = e.target;
      const size = btn.getAttribute('data-size');
      const action = btn.getAttribute('data-action');
      if (!size || !action) return;

      const inv = mantos[currentManageIndex].inventory;
      if (action === 'increase') {
        inv[size]++;
      } else if (action === 'decrease') {
        if (inv[size] > 0) inv[size]--;
      }
      // به‌روزرسانی نمایش
      manageSelect.dispatchEvent(new Event('change'));
    });

    saveChangesBtn.addEventListener('click', () => {
      alert('تغییرات ثبت شد.');
      renderMantos();
    });

    // نمایش اولیه
    renderMantos();
    populateManageSelect();
  </script>
</body>
</html>
